<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>AR Marma Visualization</title>

<style>
body { background:black; color:white; text-align:center; font-family:Arial }
.hidden { display:none }

/* finger box */
.box{
  border:2px dashed cyan;
  width:42px;
  height:120px;
  margin:auto;
}

/* camera+overlay container */
#canvasArea{
  position:relative;
  width:90vw;
  margin:auto;
}

#video{
  width:100%;
  border:2px solid cyan;
  border-radius:14px;
  display:block;
}

/* height box */
#heightBox{
  position:absolute;
  border:2px dashed yellow;
  width:120px;
  height:200px;
  left:50%;
  top:10%;
  transform:translateX(-50%);
  pointer-events:none;
}

/* marma points */
#points{
  position:absolute;
  inset:0;
}

.mar-point{
  width:14px;
  height:14px;
  background:red;
  border-radius:50%;
  border:2px solid white;
  position:absolute;
  transform:translate(-50%,-50%);
}

/* popup */
.popup{
  background:#111;
  padding:15px;
  border-radius:12px;
  border:1px solid white;
  position:fixed;
  bottom:20px;
  left:50%;
  transform:translateX(-50%);
  width:85%;
}
</style>

<!-- Mediapipe -->
<script src="https://cdn.jsdelivr.net/npm/@mediapipe/pose@0.4/pose.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@mediapipe/camera_utils@0.3/camera_utils.js"></script>



</head>
<body>

<h2>AR Based Marma Visualization<br>(Angul Parman Prototype)</h2>

<!-- single reusable camera area -->
<div id="canvasArea" class="hidden">
  <video id="video" autoplay playsinline muted></video>
  <div id="heightBox" class="hidden"></div>
  <div id="points" class="hidden"></div>
</div>

<!-- STEP 0 -->
<div id="screen0">
  <p>By continuing you consent to camera access.</p>
  <button onclick="goToFinger()">Start</button>
</div>

<!-- STEP 1 -->
<div id="screen1" class="hidden">
  <h3>Step 1 — Measure Angul</h3>
  <p>Place finger & match width</p>

  <div class="box" id="angulBox"></div>

  <input type="range" id="angulSlider" min="20" max="120" value="42" oninput="updateAngul()">

  <p>1 Angul = <span id="angulValue">42</span> pixels</p>

  <button onclick="goToHeight()">Next → Height Measurement</button>
</div>

<!-- STEP 2 -->
<div id="screen2" class="hidden">
  <h3>Step 2 — Measure Height</h3>
  <p id="status2">Camera loading…</p>

  <input type="range" id="heightSlider" min="300" max="1200" value="600" oninput="updateHeight()">

  <p>Total height in Angul = <span id="angulTotal">0</span></p>

  <button onclick="goToAR()">Start AR Visualization</button>
</div>

<!-- STEP 3 -->
<div id="screen3" class="hidden">
  <p id="statusText">Point camera at full body</p>
  <button onclick="analyze()">Analyze Body</button>
  <button onclick="switchCamera()">Switch Camera</button>
</div>

<!-- POPUP -->
<div id="popup" class="hidden popup">
  <h3 id="pTitle"></h3>
  <p id="pText"></p>
  <button onclick="closePopup()">Close</button>
</div>

<script src="script.js?v=3" defer></script>

</body>
</html>
