<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>AR Marma Visualization</title>

<style>
body{
  background:black;
  color:white;
  font-family:Arial;
  text-align:center;
}

.hidden{
  display:none !important;
}

/* CAMERA AREA */
#canvasArea{
  position:relative;
  width:90vw;
  max-width:480px;
  margin:8px auto;
}

/* VIDEO */
#video{
  width:100%;
  display:block;
  background:black;
  border:2px solid cyan;
  border-radius:12px;
}

/* skeleton overlay */
#poseCanvas{
  position:absolute;
  top:0;
  left:0;
  width:100%;
  height:100%;
  pointer-events:none;
  z-index:2;
}

/* marma overlay dots */
#points{
  position:absolute;
  inset:0;
  pointer-events:none;
  z-index:3;
}

/* clickable dots */
.marma-point{
  width:18px;
  height:18px;
  background:red;
  border:2px solid white;
  border-radius:50%;
  position:absolute;
  transform:translate(-50%,-50%);
  cursor:pointer;
  pointer-events:auto;
}

/* finger box */
.box{
  border:2px dashed cyan;
  width:42px;
  height:120px;
  margin:12px auto;
}

/* height box */
#heightBox{
  position:absolute;
  top:8%;
  left:50%;
  transform:translateX(-50%);
  width:120px;
  height:200px;
  border:2px dashed yellow;
  pointer-events:none;
}

/* popup */
.popup{
  position:fixed;
  bottom:20px;
  left:50%;
  transform:translateX(-50%);
  width:85%;
  background:#111;
  border:1px solid white;
  padding:16px;
  border-radius:14px;
  z-index:9999;
}
</style>

<!-- Mediapipe SAME VERSION as script -->
<script src="https://cdn.jsdelivr.net/npm/@mediapipe/pose@0.5/pose.js"></script>

</head>
<body>

<h2>AR Based Marma Visualization<br>(Angul Parman Prototype)</h2>

<!-- CAMERA WRAPPER -->
<div id="canvasArea" class="hidden">

  <!-- video feed -->
  <video id="video" autoplay playsinline muted></video>

  <!-- skeleton -->
  <canvas id="poseCanvas"></canvas>

  <!-- marma dots -->
  <div id="points" class="hidden"></div>

  <!-- height box (Step 2) -->
  <div id="heightBox" class="hidden"></div>

</div>


<!-- STEP 0 -->
<div id="screen0">
  <p>By continuing you consent to camera access.</p>
  <button onclick="goToFinger()">Start</button>
</div>


<!-- STEP 1 -->
<div id="screen1" class="hidden">
  <h3>Step 1 — Measure Angul</h3>
  <p>Place finger & match width</p>

  <div class="box" id="angulBox"></div>

  <input type="range" id="angulSlider" min="20" max="120" value="42" oninput="updateAngul()">

  <p>1 Angul = <span id="angulValue">42</span> pixels</p>

  <button onclick="goToHeight()">Next → Height Measurement</button>
</div>


<!-- STEP 2 -->
<div id="screen2" class="hidden">
  <h3>Step 2 — Measure Height</h3>

  <p id="status2">Camera loading…</p>

  <input type="range" id="heightSlider" min="300" max="1200" value="600" oninput="updateHeight()">

  <p>Total height in Angul = <span id="angulTotal">0</span></p>

  <button onclick="goToAR()">Start AR Visualization</button>
</div>


<!-- STEP 3 -->
<div id="screen3" class="hidden">
  <p id="statusText">Point camera at full body</p>

  <div style="margin-top:6px">
    <button onclick="analyze()">Analyze Body</button>
    <button onclick="switchCamera()">Switch Camera</button>
  </div>
</div>


<!-- POPUP -->
<div id="popup" class="hidden popup">
  <h3 id="pTitle"></h3>
  <p id="pText"></p>
  <button onclick="closePopup()">Close</button>
</div>

<script src="script.js?v=9" defer></script>

</body>
</html>
